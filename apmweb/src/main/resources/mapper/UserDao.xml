<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="apm.web.dao.apmmysql.UserDao">

    <select id="checkUser" parameterType="hashMap" resultMap="userMap">
SELECT

  u.user_id as id,
  u.name as name,
  u.pwd as pwd,
  u.phonenumber as phoneNumber,
  u.email as email
from user u WHERE u.name = #{userName} AND u.pwd = #{pwd};
    </select>

    <select id="getUserList" resultMap="userMap">

        SELECT
  u.user_id as id,
  u.name as name,
  u.pwd as pwd,
  u.phonenumber as phoneNumber,
  u.email as email
from user u;



    </select>


    <delete id="deleteUserById" parameterType="java.lang.String" >

       DELETE FROM  user  WHERE user.user_id = #{id};

    </delete>

    <update id="updateUser" parameterType="apm.web.beans.module.User">

        UPDATE user
        <trim prefix="set" suffixOverrides=",">
            <if test="name!=null">name=#{name},</if>
            <if test="pwd!=null">pwd=#{pwd},</if>
            <if test="phoneNumber!=null">phonenumber = #{phoneNumber},</if>
            <if test="email!=null">email=#{email},</if>
        </trim>
        WHERE user.user_id=#{id}
    </update>


    <insert id="addUser" parameterType="apm.web.beans.module.User">
     insert into user(user_id, name,pwd,phonenumber,email) values(#{id}, #{name}, #{pwd}, #{phoneNumber}, #{email})

    </insert>



    <select id="getUserListByIds"  resultMap="userMap">

        SELECT

          u1.user_id as id ,
        u1.name as name,
        u1.pwd as pwd,
        u1.phonenumber as phoneNumber,
        u1.email as email

        FROM
        user u1
        WHERE u1.user_id in
        <foreach item="id" index="index"  collection="userIdArr" open="( " separator="," close=" )">
            #{id}
        </foreach>
    </select>



    <resultMap id="userMap" type="apm.web.beans.module.User">


        <result property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="pwd" column="pwd"/>
        <result property="phoneNumber" column="phoneNumber"/>
        <result property="email" column="email"/>

    </resultMap>
</mapper>
